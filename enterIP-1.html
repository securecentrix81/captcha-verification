<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Show my IP</title>
</head>
<body>
  <h1>Enter Your IP Address</h1>
  
  <input id="input">
  <span style="position:absolute;bottom:0;left:0;font-size:10px" id="ip"></span>
  <script>
    let ip
    async function showIP() {
      const res = await fetch('https://api.ipify.org?format=json');
      if (!res.ok) throw new Error('Network response was not ok');
      const data = await res.json();
      ip = data.ip
      document.getElementById('ip').textContent = "Sending captcha to " + ip;
    }

    showIP();
    let ipRegex = /^(25[0-5]|2[0-4]\d|1?\d?\d)(\.(25[0-5]|2[0-4]\d|1?\d?\d)){3}$/
    let input = document.getElementById("input")
    input.addEventListener("input", (e) => {
      window.parent.postMessage({type: "enterIP-1", pass: false, text: input.value, ip: ip}, "*")
    })
  </script>
</body>
</html>
